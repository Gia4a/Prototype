# Firebase App Hosting Configuration for Static Site
runConfig:
  env:
    - variable: GEMINI_API_KEY
      value: AIzaSyCXt4Rgduq8OhQzBFW1nXdToL-4gc-OjX8
      availability:
        - RUNTIME
        - BUILD
    - variable: VITE_FIREBASE_API_KEY
      value: "AIzaSyBAsuB5hgBGYr8vz32cM4EKcs39SMI3bHQ"
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_FIREBASE_AUTH_DOMAIN
      value: "tips-and-thirst.firebaseapp.com"
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_FIREBASE_PROJECT_ID
      value: "tips-and-thirst"
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_FIREBASE_STORAGE_BUCKET
      value: "tips-and-thirst.firebasestorage.app"
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_FIREBASE_APP_ID
      value: "1:998624584520:web:fda90f99c304aaae32497d"
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_GEMINI_API_KEY
      value: AIzaSyA8u1W67q_avRWpcCSfR3u-wGLKw0-pFTI
      availability:
        - BUILD
        - RUNTIME
    - variable: VITE_GEMINI_API_URL
      value: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent"
      availability:
        - BUILD
        - RUNTIME

  cpu: 1
  memoryMiB: 512
  concurrency: 80
  minInstances: 0
  maxInstances: 100

buildConfig:
  buildCommand: |
    echo "=== Starting build process ==="
    echo "Installing frontend dependencies..."
    cd frontend && npm ci
    echo "Building frontend..."
    npm run build
    echo "Frontend build complete. Checking dist contents..."
    ls -la dist/
    echo "=== Checking assets directory ==="
    ls -la dist/assets/
    echo "=== Listing all JS files ==="
    ls -la dist/assets/*.js || echo "No JS files found"
    echo "=== Checking index.html content (first 50 lines) ==="
    head -50 dist/index.html
    echo "Moving back to root..."
    cd ..
    echo "Installing root dependencies..."
    npm ci
    echo "Build complete. Root directory contents:"
    ls -la
  startCommand: node server.js
  includedFiles:
    - frontend/**
    - server.js
    - package*.json
    - firebase.json
    - apphosting.yaml